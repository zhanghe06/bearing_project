# 数据库设计

## 映射关系: 一对多、多对一、一对一、多对多

一对多: 从球队角度来说一个球队拥有多个球员 即为一对多 

多对一: 从球员角度来说多个球员属于一个球队 即为多对一 

一对一: 就如球队与球队所在地址之间的关系，一支球队仅有一个地址，而一个地址区也仅有一支球队。

多对多: 很常见，例如学生与选修课之间的关系，一个学生可以选择多门选修课，而每个选修课又可以被多名学生选择。数据库中的多对多关联关系一般需采用中间表的方式处理，将多对多转化为两个一对多。

## 表关联设计

数据库设计思考题：

已知：用户表，收货地址表
需求：为每个用户设置默认收货地址

方案1：
用户表中设置收货地址编号作为默认地址

方案2：
收货地址表中设置默认状态

分析两种方案优劣

- 方案1

用户表，收货地址表 外键双向依赖（用户表外键：地址编号；地址表外键：用户编号）
实际上外键不能循环依赖，用户表依赖的地址编号无法设置外键，只能设置为普通字段

查询：获取用户默认地址，先在用户表中查出默认地址编号，然后在收货地址表中查询对应记录
更新：更新用户默认地址，直接在用户表中修改
删除：
    删除普通地址，无需修改
    删除默认地址，修改用户表默认地址，将最近一个地址设置为默认值
    删除全部地址，删除用户表默认地址

- 方案2

用户表，收货地址表 外键单向依赖（地址表外键：用户编号）

查询：获取用户默认地址，通过用户和默认状态2个条件在收货地址表中直接查询出来
更新：更新用户默认地址，先清空当前用户所有收货地址默认状态，再设置对应地址的默认状态，有且仅有1个默认，需要程序控制
删除：
    删除普通地址，无需修改
    删除默认地址，将最近一个地址设置为默认值
    删除全部地址，直接删除即可

